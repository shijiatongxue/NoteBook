# 面向对象和基于对象

## 面向对象

对象是一切事物的总称。

> 《面向对象分析与设计》

Grandy Boch认为，从人类的认知角度来说，对象应该是下列事物之一：

- 一个可以触摸或可以看见的东西
- 人的智力可以理解的东西
- 可以指导思考或行动的东西

**Java和C++使用类的概念来描述对象，而JavaScript使用更加冷门的概念“原型”。**为了看起来更像Java，创始人Brendan Eich引入了new、this等语言特性，使之看起来更像Java。

任何语言的运行时阶段，它的类的概念都是被弱化的。

## JavaScript对象的特征

对象有如下一个特点：

- 对象具有唯一标识：即使完全相同的对象，也并非一个对象
- 对象具有状态：对象有状态，同一对象可能处于不同状态之下
- 对象具有行为：对象的状态，可能因为它的行为产生变迁

对象的唯一标识，都是用内存地址来体现的。对象具有唯一标识的内存地址，所有具有唯一标识。

```js
let o1 = {a: 1};
let o2 = {a: 1};

console.log(o1 == o2); // false
```

对象的第二个和第三个特征为状态和行为，不同的语言会使用不同的术语来抽象描述它们。比如C++中称它们为“成员变量”和“成员函数”，Java中称它们为“属性”和“方法”。

**在JavaScript中，将状态和行为统一抽象为“属性”。**其中函数是一种特殊的对象。

```js
let o = {
  d: 1,
  f() {
  	console.log(this.d);
  }
}

let fc = o.f

fc(); // undefined
o.f(); // 1
```

**在实现了对象基本特征的基础上，JavaScript中独享独有的特色是：对象具有高度动态性，这是因为JavaScript赋予了使用者在运行时为对象添改状态和行为的能力。**

如运行时为对象添加属性：

```js
let o = {a: 1};
o.b = 2;
console.log(o.a, o.b); // 1 2
```

为了提高抽象能力，JavaScript的属性被设计成比别的语言更加复杂的形式，它提供了数据属性和访问器属性（getter/setter）两类。

## JavaScript对象的两类属性

对JavaScript来说，属性并非只是简答的名称和值，JavaScript用一组特征来描述属性。

第一类属性，**数据属性**。

- value：属性的值
- writable：决定是否被被赋值
- enumerable：决定for in是否枚举该属性
- configurable：决定该属性是否被删除或者改变特征值

第二类属性，**访问器属性**，它也有四个特征。

- getter：函数或undefined，在取属性值时被调用
- setter：函数或undefined，在设置属性值时被调用
- enumerable：决定for in是否枚举该属性
- configurable：决定该属性是否被删除或者改变特征值

访问器属性使得属性在读和写时执行代码，它允许使用者在写和读属性时，得到完全不同的值，它可以视为一种函数的语法糖。

我们通常用于定义属性的代码会产生**数据属性**，其中的writable、enumerable、configurable都默认为true。我们可以使用内置的函数Object.getOwnPropertyDescriptor来查看：

```js
let o = {a: 1};
o.b = 2;

Object.getOwnPropertyDescriptor(o, "b");
Object.getOwnPropertyDescriptor(o, "a");

// {value: 2, writable: true, enumerable: true, configurable: true}
// {value: 1, writable: true, enumerable: true, configurable: true}
```

结果发现，使用两种方式定义的属性都是数据属性，writable、enumerable、configurable都默认为true

如果我们要想改变属性特征，或者定义访问器属性，我们可以使用Object.defineProperty：

```js
let o = {a: 1};
Object.defineProperty(o, "b", {value: 2, writale: false, enemerable: false, configurable: true});

Object.getOwnPropertyDescriptor(o, "b");
Object.getOwnPropertyDescriptor(o, "a");
// {value: 2, writable: false, enumerable: false, configurable: true}
//{value: 1, writable: true, enumerable: true, configurable: true}

o.b = 3;
o.b;
// 2
```

因为b的writable为false，所以对它赋值，b的值不会发生变化。

创建对象时，也可以使用get和set关键字来创建**访问器属性**：

```js
let o = {
  get a() {
		return 1;
  }
}

console.log(o.a); // 1
```

访问器属性跟数据属性不同，每次访问属性都会执行getter或setter函数。这里我们的getter返回了1，所以o.a每次都得到1。

这样，我们就理解了，实际上JavaScript对象的运行时是一个“属性的集合”，属性以字符串或者Symbol为key，以属性特征值或者访问器属性特征值为value。

对象是一个属性的索引结构。以上面的对象o为例，想象一个“a”是key，{value: 1, writable: true, enumerable: true, configurable: true}是value。

## 总结

JavaScript提供了完全运行时的对象系统，这使得它可以模仿多数面向对象编程范式（JavaScript中两种面向对象编程的范式：基于类和基于原型），所以它也是正统的面向对象语言。

JavaScript语言标准明确说明，JavaScript是一门面向对象的语言。

---

来自：重学前端



















